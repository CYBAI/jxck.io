# [amp][ecosystem][web] Web のエコシステムの視点から見た AMP

## Intro

Web はエコシステムで作るものだと思っている。

現在の Web プラットフォームを使いこなすには、必要な知識や技術があまりに多すぎる。

一方で、それらがきちんと抑えられていないと、例え望む機能が実現できても、パフォーマンス・アクセシビリティ・セキュリティ・デザインといった、非機能要件まで満たすのは難しい。

だから、エコシステムを育て、エコシステムで作る。

では、 AMP はエコシステムの環の中に入ってるのだろうか？


## そびえ立つスタック

レンタルサーバに、コピペした HTML を置いただけでも立派な Web ページだ。

しかし、より複雑な機能を実装しようと思えば、多少のスキルが必要になる。

機能が複雑になれば、必ずトレードオフが生まれてしまう。

トレードオフとは、機能的なバグだけに留まらない。

遅い、ダサい、使いにくい、脆弱。

しかし、全てのエンジニアが、パフォーマンスに気を使い、堅牢で、イケてるくせに使いやすいサイトが作れるかというと、それは無いだろう。

全てどころか、一人でもそれをスクラッチで全部こなせるエンジニアが本当にいるのだろうか？

少なくとも筆者は知らない。


## 一人でできる必要は無い

もし、作っているものが趣味で無いのならば、わざわざ全てを一人で、ましてやスクラッチで作る必要は無いだろう。

得意な技術がある人をあつめて、チームを作り、分担すればいい。

全部をこなせるエンジニアは知らないといったが、全部をこなしているチームならいくつか知っている。

少しスコープを絞れば、長けている人はゼロでは無いからだ。


別にその人が、チーム内にいなくてもいい。

フォントに長けた人は少ないだろう、その場合はフォントだけ買ってくればいい。

脆弱性を見つけるのに長けた人もいる、きっと多少のお金を払って教えてもらっても損はしないだろう。

そのサイトが本当にアクセシブルなのかを、検査してくれる会社もある。自分にできないことは、誰かがビジネスにしているだろう。


## コードは共有できる

スキルは共有が難しいが、コードは共有できることは、このブログを読んでいるような人なら身をもって知っていると思う。

むしろ、普遍的で、再現性があり、再利用がしやすいという意味で、よっぽど使いやすいだろう。

つまり、属人的なスキルをコードに落としこんで、再利用できれば、多くの人が嬉しいのだ。

最たる例がフレームワークだ。


例えば Rails は、 HTTP を抽象化しているだけじゃなく、 Web 開発に必要な多くのベストプラクティスを取り入れている。

ところであなたは HTML で Form を正しくマークアップできるだろうか？

過不足無い HTTP ヘッダを付与できているだろうか？

CSRF 攻撃への対策として、 Rails が裏でやってくれていることをきちんと説明できるだろうか？

Rails を使って Web 開発しているエンジニアの多くは Rails の使い方は知っていても、 Rails が裏で行ってくれている全てのことを把握しているとは限らないだろう。

でもそれで良い、 Rails 開発者やコントリビュータが持っている知見は、コードに姿を変えて Rails に取り込まれている。

だから開発者は「Rails を正しく使う」ことに注力すればいいし、レビューも「レールから逸れていないか」をまず見ればいい。


そうすればおおよそ既知の大事故は発生しないだろう、変わりに「レースを逸れる」時は相当の覚悟と調査を重ねた上で行う必要がある。



Twitter Bootstrap や jQuery なども同じような役割をそれぞれのスコープで行っていた。

もちろん全てがうまく行っていたとは限らないが。



もし Web 開発におけるベストプラクティスを見つけたら、それを周りのエンジニアに伝えるのもいい、ブログを書くのもいい、どこかで発表するのもいいだろう。

しかし、 Rail を使っている人がそのエントリ/スライドを見るとは限らない。でもその知見が Rails にコードとして取り込まれれば、アップデートするだけで確実に伝わるだろう。


だから筆者は、(Rails に限らず)フレームワークを使うことを進めるし、そのフレームワークがアクティブに開発されて、多くの人に使われていることを重視する。

流行ってるからと思ってもらっていい、そこには少なくともエコシステムが回っているからだ。それがいつまで続くかは別として。



## 依存(する意味)解決(する価値)

知見がコードになったなら、重要なのはそのコードのパッケージングと共有だ。

これは色々な用途で作らているが、 Web でいえば gem や npm みたいなものが最近は選ばれている。

なぜそれが必要かというと、自分が持っている知見が単体でコードに落とせることはほとんど無いからだ。


XSS のためにエスケープすべき文字を知っている人がいても、その人がテンプレートエンジンを書く技術を持っているとは限らない。

ECDH が実装できる人がいたとしても、その人は Web-Push を実装するためにそれが必要になるだなんて知らないかもしれない。

だから互いに依存する。依存を解決するプラットフォームがあれば、知見の融合は有機的に広がっていく。



## Web におけるモジュール

モジュール、コンポーネント、パッケージ、プラグイン色々な形があるが、要するに共有する単位がなにかしらある。

その単位自体が、そのプラットフォームでサポートされているのが一番望ましい。

Ruby にも Node にもそれはあった、しかし Web には長いことそれらしいものがなかった。


WebComponents や ES Modules によってだいぶ形がかわるだろう。

モジュールを作り、それを組み合わせる。




## AMP

実は AMP はまさしくその形をしている。


では、 AMP はエコシステムなのか？



## ベンダと標準


ベンダロックイン

それを標準化する意味



## 理想と現実


普及、使われること、 google が書いたほうが良い問題。














