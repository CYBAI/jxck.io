# [amp][es modules][ecosystem][web] Web のエコシステムの視点から見た AMP

## Intro

Web はエコシステムで作るものだと思っている。

現在の Web プラットフォームを使いこなすには、必要な知識や技術があまりに多すぎる。

一方で、それらがきちんと抑えられていないと、例え望む機能が実現できても、パフォーマンス/アクセシビリティ/セキュリティ/デザインといった、非機能要件まで満たすのは難しい。

だから、エコシステムを育て、エコシステムで作る。

そのための土台が、少しづつ整いつつある。


## そびえ立つスタック

レンタルサーバに、コピペした HTML を置いただけでも立派な Web ページだ。

しかし、より複雑な機能を実装しようと思えば、多少のスキルが必要になる。

機能が複雑になれば、必ずトレードオフが生まれてしまう。

トレードオフとは、機能的なバグだけに留まらない。

遅い、ダサい、使いにくい、脆弱。

しかし、全てのエンジニアが、パフォーマンスに気を使い、堅牢で、イケてるくせに使いやすいサイトが作れるかというと、それは無いだろう。

全てどころか、一人でもそれをスクラッチで全部こなせるエンジニアが本当にいるのだろうか？

少なくとも筆者は知らない。


## 一人でできる必要は無い

もし、作っているものが趣味で無いのならば、わざわざ全てを一人で、ましてやスクラッチで作る必要は無いだろう。

得意な技術がある人を集め、チームを作り、分担することはできる。

全部をこなせるエンジニアは知らないといったが、全部をこなしているチームならいくつか知っている。

少しスコープを絞れば、長けている人はゼロでは無いからだ。

別にその人が、チーム内にいなくてもいい。

フォントに長けた人は少ないだろう、その場合はフォントだけ買ってくればいい。

脆弱性を見つけるのに長けた人もいる、多少のお金を払って見つけてもらっても損はしないだろう。

そのサイトが本当にアクセシブルなのかを、検査してくれる会社もある。

自分にできないことも、誰かがビジネスにしている場合が多い。　


## 共有資産としてのコード

スキルは共有が難しいが、コードは共有できる。

むしろ、普遍性、再現性、再利用性で言えば、コードのほうが長けている。

つまり、属人的なスキルをコードに落としこんで、共有できれば、多くの人が嬉しい。

最たる例がフレームワークだ。

例えば Rails は、 HTTP を抽象化しているだけじゃなく、 Web 開発に必要な多くのベストプラクティスのいくつかを取り入れている。

ところであなたは HTML で Form を正しくマークアップできるだろうか？

過不足無い HTTP ヘッダを付与できているだろうか？

CSRF 攻撃への対策として、 Rails が裏でやってくれていることをきちんと説明できるだろうか？

Rails を使って Web 開発しているエンジニアの多くは Rails の使い方は知っていても、 Rails が裏で行ってくれている全てのことを把握しているとは限らないかもしれない。

でもそれで良い、 Rails 開発者やコントリビュータが持っている知見は、コードに姿を変えて Rails に取り込まれている。

だから開発者は「Rails を正しく使う」ことに注力すればいいし、レビューも「レールから逸れていないか」をまず見ればいい。

そうすればおおよそ既知の大事故は発生しないだろう。

変わりに「レースを逸れる」時は、相当の覚悟と調査とレビューを重ねた上で行う必要があると合意できる。

Twitter Bootstrap や jQuery なども同じような役割をそれぞれのスコープで行っていた。

もちろん全てがうまく行っていたとは限らない。


## どこに知識を落とし込むか

もし Web 開発におけるベストプラクティスを見つけたら、それを周りのエンジニアに伝えるのもいい、ブログを書くのもいい、どこかで発表するのも価値があるだろう。

しかし、 Rail を使っている人がそのエントリ/スライドを見るとは限らない、発表の場にいられるのは全体から見ればひとにぎりだ。

ただ、その知見が Rails にコードとして取り込まれれば、アップデートするだけで広く伝わるだろう。

だから筆者は、(Rails に限らず)フレームワークを使うことを進めるし、そのフレームワークがアクティブに開発されて、多くの人に使われていることを重視する。

**流行ってるものを使う** という方針は **そこに回っているエコシステムを使う** という意味だ。

標準ライブラリだけあれば、自分で全部書きあげてやると思っている人は、別にやればいい。本当にできるなら。


## 依存(する意味)解決(する価値)

知見がコードになったなら、重要なのはそのコードのパッケージングと共有だ。

これは色々な用途で作らているが、 Web でいえば gem や npm みたいなものが最近は選ばれている。

なぜそれが必要かというと、自分が持っている知見が単体でコードに落とせることはほとんど無いからだ。

XSS のためにエスケープすべき文字を知っている人がいても、その人がテンプレートエンジンを書く技術を持っているとは限らない。

ECDH が実装できる人がいたとしても、その人は Web-Push を実装するためにそれが必要になるだなんて知らないかもしれない。

だから互いに依存する。依存を解決するプラットフォームがあれば、知見の融合は有機的に広がっていく。


## Web におけるモジュール

モジュール、コンポーネント、パッケージ、プラグイン色々な形があるが、要するに共有する単位がなにかしらある。

その単位自体が、そのプラットフォームでサポートされているのが一番望ましい。

Ruby にも Node にもそれはあった、しかし Web には長いことそれらしいものがなかった。

WebComponents や ES Modules によってだいぶ形がかわるだろう。

モジュールを作り、それを組み合わせる。




## AMP

実は AMP はまさしくその形をしている。


では、 AMP はエコシステムなのか？



## ベンダと標準


ベンダロックイン

それを標準化する意味



## 理想と現実


普及、使われること、 google が書いたほうが良い問題。
