<!DOCTYPE html>
<meta charset=utf-8>
<meta name=viewport content='width=device-width,initial-scale=1'>
<meta name=description content=demo>
<title>DEMO</title>
<h1>Test</h1>
<script>
function loop(ws, n) {
    if(n === 0) return ws.close();
    ws.onmessage = (ev) => {
        console.log('send', ev.data);
        loop(ws, n - 1);
    }
    let rand = btoa(Math.random());
    console.log('recv', rand);
    ws.send(rand);
}

ws = new WebSocket('ws://localhost:3000', [])
ws.onopen = (e) => {
    loop(ws, 10)
}
</script>
