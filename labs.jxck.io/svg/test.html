<!DOCTYPE html>
<meta charset=utf-8>
<title>title</title>
<!-- meta http-equiv=refresh content=1 -->

<style>
body {
  padding: 2em;
}
pre {
  background-color: #ccc;
}
img, svg {
  display: block;
  width: 300px;
  height: 300px;
  background: black;
  border: 1px solid black;
}

</style>

<h1>SVG 強者への質問</h1>
<h2>img 読み込み</h2>
<p>最終的に表示したいのがこれ。これは SVG ファイルにまとめて img で読んでいる
<p>svg の中には二つの clipPath がある。
<img src=push.img.svg>
<p><a href=push.img.svg>push.img.svg</a>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300"&gt;

&lt;!-- ベルの下の丸を、半円にするクリップ --&gt;
&lt;clipPath id="cut-off-top"&gt;
  &lt;rect x="0" y="250" width="200" height="40" /&gt;
&lt;/clipPath&gt;

&lt;!-- 外側の二つの輪っかを、左右だけ残すクリップ --&gt;
&lt;clipPath id="cut-off-circle"&gt;
  &lt;path d="
  M 150,120
  L 10,60
  L 10,220
  L 150,150
  L 290,220
  L 290,60
  L 150,120
  "
  fill="red"
  /&gt;
&lt;/clipPath&gt;

&lt;circle
  cx="150"
  cy="40"
  r="14"
  fill="#fff"&gt;
&lt;/circle&gt;

&lt;circle
  cx="150"
  cy="120"
  r="70"
  fill="#fff"&gt;
&lt;/circle&gt;

&lt;rect
  x="80"
  y="120"
  width="140"
  height="70"
  fill="#fff"
/&gt;

&lt;path d="
M 80, 170
L 50, 240
L 250,240
L 220,170
L 80,170
"
fill="#fff"
/&gt;

&lt;circle
  cx="150" cy="250" r="30"
  fill="#fff"
  clip-path="url(#cut-off-top)"
/&gt;

&lt;circle
  cx="150" cy="150" r="130"
  stroke="#fff"
  stroke-width="12"
  fill="transparent"
  clip-path="url(#cut-off-circle)"
/&gt;

&lt;circle
  cx="150" cy="150" r="110"
  stroke="#fff"
  stroke-width="12"
  fill="transparent"
  clip-path="url(#cut-off-circle)"
/&gt;

&lt;/svg&gt;

</pre>


<h2>svg で use したい</h2>
<p>JS/CSS で fill などを弄るには svg から use しないといけないらしいので、 img をやめたい
<p>clipPath を HTML 側の svg タグに書くと、 use した SVG からそれを url(#path) で参照できている
<svg>
  <clipPath id="cut-off-top-dummy">
    <rect x="0" y="250" width="200" height="40" />
  </clipPath>

  <clipPath id="cut-off-circle-dummy">
    <path d="
    M 150,120
    L 10,60
    L 10,220
    L 150,150
    L 290,220
    L 290,60
    L 150,120
    "
    fill="red"
    />
  </clipPath>

  <use xlink:href="push.use.svg#main"/>
</svg>
<p><a href=push.use.svg>push.use.svg</a>
<pre>
&lt;svg&gt;
  &lt;clipPath id="cut-off-top-dummy"&gt;
    &lt;rect x="0" y="250" width="200" height="40" /&gt;
  &lt;/clipPath&gt;

  &lt;clipPath id="cut-off-circle-dummy"&gt;
    &lt;path d="
    M 150,120
    L 10,60
    L 10,220
    L 150,150
    L 290,220
    L 290,60
    L 150,120
    "
    fill="red"
    /&gt;
  &lt;/clipPath&gt;

  &lt;use xlink:href="push.use.svg#main"/&gt;
&lt;/svg&gt;
</pre>

<h2>clip-path も一つのファイルにしたい</h2>
<p>最終的にやりたいこと。以下のファイルのように、一つのファイルに cliepPath もまとめて、 use しただけで読みたい。
<p>でも同じファイルに書いた clipPath が url(#path) で読めない。。
<p>これはどう書いたらよいのでしょう？
<svg>
  <use xlink:href="push.want.svg#main"/>
</svg>
<p><a href=push.want.svg>push.want.svg</a>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 300 300"&gt;

&lt;!-- こいつらは、なぜ参照されないのか?? --&gt;
&lt;clipPath id="cut-off-top"&gt;
  &lt;rect x="0" y="250" width="200" height="40" /&gt;
&lt;/clipPath&gt;

&lt;clipPath id="cut-off-circle"&gt;
  &lt;path d="
  M 150,120
  L 10,60
  L 10,220
  L 150,150
  L 290,220
  L 290,60
  L 150,120
  "
  fill="red"
  /&gt;
&lt;/clipPath&gt;

&lt;defs&gt;
&lt;g id="main"&gt;
  &lt;circle
    cx="150"
    cy="40"
    r="14"
    fill="#fff"&gt;
  &lt;/circle&gt;

  &lt;circle
    cx="150"
    cy="120"
    r="70"
    fill="#fff"&gt;
  &lt;/circle&gt;

  &lt;rect
    x="80"
    y="120"
    width="140"
    height="70"
    fill="#fff"
  /&gt;

  &lt;path d="
  M 80, 170
  L 50, 240
  L 250,240
  L 220,170
  L 80,170
  "
  fill="#fff"
  /&gt;

  &lt;circle
    cx="150" cy="250" r="30"
    fill="#fff"
    clip-path="url(#cut-off-top)"
  /&gt;

  &lt;circle
    cx="150" cy="150" r="130"
    stroke="#fff"
    stroke-width="12"
    fill="transparent"
    clip-path="url(#cut-off-circle)"
  /&gt;

  &lt;circle
    cx="150" cy="150" r="110"
    stroke="#fff"
    stroke-width="12"
    fill="transparent"
    clip-path="url(#cut-off-circle)"
  /&gt;
&lt;/g&gt;

&lt;/defs&gt;
&lt;/svg&gt;
</pre>
